# Ory Kratos Environment Configuration
# Copy this file to .env and customize the values

# ====================
# Project Settings
# ====================
PROJECT_NAME=kratos
TZ=Asia/Seoul

# ====================
# Port Configuration
# ====================
# Kratos public API port
KRATOS_PUBLIC_PORT=4433

# Kratos admin API port
KRATOS_ADMIN_PORT=4434

# Kratos UI port
KRATOS_UI_PORT=4455

# MailSlurper SMTP port
MAILSLURPER_SMTP_PORT=1025

# MailSlurper Web UI port
MAILSLURPER_UI_PORT=4436

# MailSlurper API port
MAILSLURPER_API_PORT=4437

# ====================
# Database Configuration (PostgreSQL)
# ====================
POSTGRES_USER=kratos
POSTGRES_PASSWORD=secret
POSTGRES_DB=kratos
POSTGRES_HOST=postgres
POSTGRES_PORT=5432

# ====================
# Kratos Configuration
# ====================
# Database DSN (Data Source Name)
# SQLite (default for development):
DSN=sqlite:///var/lib/sqlite/db.sqlite?_fk=true&mode=rwc

# PostgreSQL (recommended for production):
# DSN=postgres://kratos:secret@postgres:5432/kratos?sslmode=disable&max_conns=20&max_idle_conns=4

# Log level (panic, fatal, error, warn, info, debug, trace)
LOG_LEVEL=trace

# ====================
# Kratos UI Configuration
# ====================
# UI port
UI_PORT=4455

# Security mode (leave empty for development)
SECURITY_MODE=

# Kratos URLs
KRATOS_BROWSER_URL=http://127.0.0.1:4433/
KRATOS_PUBLIC_URL=http://kratos:4433/

# Cookie secrets (change in production!)
COOKIE_SECRET=changeme
CSRF_COOKIE_NAME=ory_csrf_ui
CSRF_COOKIE_SECRET=changeme

# ====================
# Email Configuration
# ====================
# SMTP settings (for production)
# SMTP_CONNECTION_URI=smtps://username:password@smtp.example.com:465
# SMTP_FROM_ADDRESS=noreply@example.com
# SMTP_FROM_NAME=My Application

# MailSlurper (for development/testing)
MAILSLURPER_SMTP=mailslurper:1025

# ====================
# Container Names
# ====================
POSTGRES_CONTAINER_NAME=kratos-postgres
KRATOS_CONTAINER_NAME=kratos
KRATOS_MIGRATE_CONTAINER_NAME=kratos-migrate
KRATOS_UI_CONTAINER_NAME=kratos-ui-node
MAILSLURPER_CONTAINER_NAME=kratos-mailslurper

# ====================
# Volume Names
# ====================
POSTGRES_VOLUME=postgres
KRATOS_SQLITE_VOLUME=kratos-sqlite

# ====================
# Network Names
# ====================
NETWORK_NAME=intra-network

# ====================
# Configuration Paths
# ====================
# Kratos config directory (relative to compose.yml)
KRATOS_CONFIG_PATH=./kratos/contrib/quickstart/kratos/email-password

# UI source directory
KRATOS_UI_PATH=./ory-kratos-selfservice-ui-node

# ====================
# Security Note
# ====================
# ⚠️ IMPORTANT: Change all secrets before using in production!
# - POSTGRES_PASSWORD: Database password
# - COOKIE_SECRET: Cookie encryption secret
# - CSRF_COOKIE_SECRET: CSRF protection secret
#
# Security recommendations:
# - Use PostgreSQL instead of SQLite for production
# - Enable HTTPS/TLS for all endpoints
# - Configure proper CORS settings
# - Use strong, random secrets (32+ characters)
# - Enable rate limiting
# - Configure proper session management
# - Set up monitoring and alerting
# - Regular security updates
#
# Generate random secrets:
# openssl rand -base64 32
#
# Initial setup:
# 1. Clone Kratos repository:
#    git clone https://github.com/ory/kratos.git
# 2. Clone UI repository:
#    git clone https://github.com/ory/kratos-selfservice-ui-node.git ory-kratos-selfservice-ui-node
# 3. Copy this file to .env and update values
# 4. Run: docker compose up -d
# 5. Access UI: http://localhost:4455
