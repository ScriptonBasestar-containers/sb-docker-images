# Ethereum Geth Environment Configuration
# Copy this file to .env and customize the values

# ====================
# Project Settings
# ====================
PROJECT_NAME=ethereum
TZ=Asia/Seoul

# ====================
# Port Configuration
# ====================
# Geth HTTP JSON-RPC port
GETH_HTTP_PORT=8545

# Geth WebSocket port
GETH_WS_PORT=8546

# Geth P2P TCP port
GETH_P2P_TCP_PORT=30303

# Geth P2P UDP port
GETH_P2P_UDP_PORT=30303

# BlockScout web UI port
BLOCKSCOUT_PORT=4000

# ====================
# Geth Configuration
# ====================
# Sync mode (snap, full, light)
# - snap: Fast sync (recommended, ~200GB)
# - full: Full archive (slow, ~14TB+)
# - light: Light client (faster, ~1GB)
SYNC_MODE=snap

# Garbage collection mode (full, archive)
# - full: Regular garbage collection (saves disk space)
# - archive: Keep all historical states (requires huge disk space)
GCMODE=archive

# Cache size in MB (default: 1024)
# Recommended: 2048-8192 MB for better performance
CACHE=2048

# ====================
# Geth HTTP RPC Configuration
# ====================
# HTTP RPC enabled
HTTP_ENABLED=true

# HTTP bind address
HTTP_ADDR=0.0.0.0

# HTTP port
HTTP_PORT=8545

# HTTP CORS domains
HTTP_CORSDOMAIN=*

# HTTP virtual hosts
HTTP_VHOSTS=*

# HTTP API modules
HTTP_API=eth,net,web3,personal,admin

# ====================
# Geth WebSocket Configuration
# ====================
# WebSocket enabled
WS_ENABLED=true

# WebSocket bind address
WS_ADDR=0.0.0.0

# WebSocket port
WS_PORT=8546

# WebSocket allowed origins
WS_ORIGINS=*

# WebSocket API modules
WS_API=eth,net,web3,personal,admin

# ====================
# Network Configuration
# ====================
# Network ID (1=mainnet, 5=goerli, 11155111=sepolia)
# NETWORK_ID=1

# Custom network (for private networks)
# NETWORK_ID=custom

# ====================
# BlockScout Configuration
# ====================
# Secret key base for BlockScout (minimum 64 chars)
SECRET_KEY_BASE=change-me-to-random-secret-key-min-64-chars-use-openssl-rand-base64-64

# Ethereum JSON-RPC variant
ETHEREUM_JSONRPC_VARIANT=geth

# Ethereum HTTP RPC URL
ETHEREUM_JSONRPC_HTTP_URL=http://geth:8545

# Ethereum WebSocket URL
ETHEREUM_JSONRPC_WS_URL=ws://geth:8546

# ====================
# PostgreSQL Configuration (for BlockScout)
# ====================
# PostgreSQL password
POSTGRES_PASSWORD=change-me-strong-password

# PostgreSQL database
POSTGRES_DB=blockscout

# PostgreSQL user
POSTGRES_USER=postgres

# Database URL for BlockScout
DATABASE_URL=postgresql://postgres:change-me-strong-password@postgres:5432/blockscout

# ====================
# Container Names
# ====================
GETH_CONTAINER_NAME=geth
BLOCKSCOUT_CONTAINER_NAME=eth-explorer
POSTGRES_CONTAINER_NAME=eth-postgres

# ====================
# Volume Names
# ====================
GETH_DATA_VOLUME=geth-data
POSTGRES_DATA_VOLUME=postgres-data

# ====================
# Network Names
# ====================
NETWORK_NAME=ethereum-network

# ====================
# Security Note
# ====================
# ⚠️ IMPORTANT: Security considerations for Ethereum nodes!
# - SECRET_KEY_BASE: Change to random 64+ char string
# - POSTGRES_PASSWORD: Use strong password
# - HTTP/WS APIs: Restrict access in production
# - CORS/Origins: Limit to specific domains in production
#
# Security recommendations:
# - Never expose RPC ports to public internet
# - Use firewall rules to restrict access
# - Enable authentication for RPC endpoints
# - Use HTTPS/WSS with reverse proxy
# - Keep Geth updated for security patches
# - Secure private keys properly
# - Use hardware wallet for production
# - Regular backups of blockchain data
#
# Generate SECRET_KEY_BASE:
# openssl rand -base64 64
#
# Network modes:
# - Mainnet: Default, real ETH and transactions
# - Testnet (Goerli): Test network with free test ETH
# - Testnet (Sepolia): Newer test network
# - Private network: Your own custom network
#
# Initial setup:
# 1. Copy this file to .env
# 2. Change SECRET_KEY_BASE and POSTGRES_PASSWORD
# 3. Choose sync mode (SYNC_MODE)
# 4. Start Geth only: docker compose up -d geth
# 5. Or start all services: docker compose up -d
# 6. Wait for blockchain sync (can take hours/days)
# 7. Access BlockScout: http://localhost:4000
#
# Geth CLI usage:
# # Attach to Geth console
# docker compose exec geth geth attach http://localhost:8545
#
# # Inside Geth console:
# > eth.syncing        # Check sync status
# > eth.blockNumber    # Get current block
# > net.peerCount      # Get peer count
# > eth.accounts       # List accounts
# > personal.newAccount("password")  # Create account
# > eth.getBalance(eth.accounts[0])  # Check balance
#
# Common Geth commands (outside console):
# - Create account:
#   docker compose exec geth geth account new
#
# - List accounts:
#   docker compose exec geth geth account list
#
# - Check sync status:
#   docker compose exec geth geth attach --exec "eth.syncing"
#
# - Get block number:
#   docker compose exec geth geth attach --exec "eth.blockNumber"
#
# Blockchain sync:
# - Mainnet snap: ~200GB+, takes hours-days
# - Mainnet full archive: ~14TB+, takes weeks
# - Light mode: ~1GB, fastest
#
# Performance tuning:
# - Increase CACHE for faster sync (4096-8192 MB)
# - Use SSD for better performance
# - Ensure stable internet connection
#
# Monitoring:
# - Sync progress: eth.syncing
# - Peer count: net.peerCount
# - Block number: eth.blockNumber
# - Gas price: eth.gasPrice
# - Pending transactions: txpool.status
#
# Web3 API usage:
# curl -X POST -H "Content-Type: application/json" \
#   --data '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' \
#   http://localhost:8545
#
# Testnet setup (Sepolia):
# Add to geth command:
# --sepolia
#
# Private network setup:
# 1. Create genesis.json
# 2. Initialize: geth init genesis.json
# 3. Run with --networkid and --nodiscover
#
# BlockScout features:
# - Block explorer
# - Transaction search
# - Smart contract verification
# - Token tracking
# - Address analytics
# - API endpoints
#
# Backup strategy:
# 1. Backup keystore files (accounts)
# 2. Save private keys securely
# 3. Backup genesis.json (for private networks)
# 4. Consider using node snapshots for faster recovery
#
# References:
# - Geth documentation: https://geth.ethereum.org/docs
# - Ethereum JSON-RPC: https://ethereum.org/en/developers/docs/apis/json-rpc/
# - BlockScout: https://docs.blockscout.com/
# - Port guide: ../docs/PORT_GUIDE.md
