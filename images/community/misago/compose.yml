# Misago Forum - Simplified Setup
# For full setup with nginx-proxy, clone from:
# https://github.com/rafalp/misago_docker
services:
  postgres:
    image: postgres:15
    restart: unless-stopped
    environment:
      - POSTGRES_DB=${MISAGO_POSTGRES_DB:-db01}
      - POSTGRES_USER=${MISAGO_POSTGRES_USER:-user01}
      - POSTGRES_PASSWORD=${MISAGO_POSTGRES_PASSWORD:-passw0rd}
      - ENABLE_IPV6=true
    volumes:
      - misago-postgres-15:/var/lib/postgresql/data

  redis:
    image: redis:8.2-alpine
    restart: unless-stopped
    volumes:
      - misago-redis-6:/data

  misago:
    image: rafalp/misago:latest
    container_name: ${CONTAINER_NAME:-misago}
    ports:
      - "${WEB_PORT:-8092}:8000"
    restart: unless-stopped
    environment:
      - POSTGRES_HOST=${MISAGO_POSTGRES_HOST:-postgres}
      - POSTGRES_DB=${MISAGO_POSTGRES_DB:-db01}
      - POSTGRES_USER=${MISAGO_POSTGRES_USER:-user01}
      - POSTGRES_PASSWORD=${MISAGO_POSTGRES_PASSWORD:-passw0rd}
      - REDIS_URL=redis://redis:6379/0
    depends_on:
      - postgres
      - redis
    volumes:
      - misago-media:/misago/media
      - misago-static:/misago/static

volumes:
  misago-postgres-15:
  misago-redis-6:
  misago-media:
  misago-static: